This repository contains a minimal, clean implementation of the Byte Pair Encoding (BPE) and SentencePiece algorithm, which are commonly used for tokenization in large language models (LLMs). The BPE algorithm operates at the byte level, processing UTF-8 encoded strings. This algorithm was popularized for LLMs by the <a href="https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf">GPT-2</a> paper.
SentencePiece operates at the subword level.It is particularly useful for handling out-of-vocabulary words and rare words in a robust manner. Today, all modern LLMs (e.g. GPT, Llama, Mistral) use these algorithm to train their tokenizers.

There are two Tokenizers in this repository, both of which can perform the 3 primary functions of a Tokenizer: 1) train the tokenizer vocabulary and merges on a given text, 2) encode from text to tokens, 3) decode from tokens to text. The files of the repo are as follows:
1.	minbpe/base.py: Implements the Tokenizer class, which is the base class. It contains the train, encode, and decode stubs, save/load functionality, and there are also a few common utility functions. This class is not meant to be used directly, but rather to be inherited from.
2.	minbpe/basic.py: Implements the BasicTokenizer, the simplest implementation of the BPE algorithm that runs directly on text.
3.	minbpe/my_regex.py: Implements the RegexTokenizer that further splits the input text by a regex pattern, which is a preprocessing stage that splits up the input text by categories (think: letters, numbers, punctuation) before tokenization. This ensures that no merges will happen across category boundaries. This was introduced in the GPT-2 paper and continues to be in use as of GPT-4. This class also handles special tokens, if any.
4.	minbpe/gpt4.py: Implements the GPT4Tokenizer. This class is a light wrapper around the RegexTokenizer (2, above) that exactly reproduces the tokenization of GPT-4 in the tiktoken library. The wrapping handles some details around recovering the exact merges in the tokenizer, and the handling of some unfortunate (and likely historical?) 1-byte token permutations.
5.   minbpe/train_spm: Implements the `GPT4Tokenizer` class. This is a custom tokenizer that utilizes the SentencePiece algorithm for tokenization, tailored specifically for the GPT-4 language model. The class is a wrapper around the SentencePiece library, handling the details of training the SentencePiece model, encoding and decoding text, and managing special tokens unique to GPT-4. It also provides functionality to save the vocabulary to a file for future reference.

Finally, the script train.py trains the two major tokenizers on the input text tests/taylorswift.txt (this is the Wikipedia entry for her kek) and saves the vocab to disk for visualization.

